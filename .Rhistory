ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs, las = 2)
}
#
# points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
# lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 2.3)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("S-G", "S-F", "G-F")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
cairo_pdf(file ="./plots/FE-2020-00824_Figure_3.pdf",
width = 7,
height=7,
pointsize = 9)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.12, -.05, 0.03, .05, -.06, .05, -.08, .05, -.15, 0.02)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
cairo_pdf(file ="./plots/FE-2020-00824_Figure_4.pdf",
width = 5,
height=8,
pointsize = 9)
par(mfrow = c(5,2))
par(oma = c(1,1,3,0), mar = c(4,5,1,1), family = "sans")
for(i in 1:length(traits_to_plot)){
trait <- traits_to_plot[i]
plot(plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA,
xlab = "",
ylab = "",
ylim = c(min(plot_agg_traits[, eval(substitute(trait))]), max(plot_agg_traits[, eval(substitute(trait))]) * 1.05),
pch = 21,
bg = "grey",
yaxt = "n")
axis(2, las = 2)
temp <- summary(lm( plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA))
if(!(i %in% c(3,4,5,9))){
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
} else{
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
}
mtext(side = 2, text = traits_names_clean[i], line = 2.6, cex = 0.8)
mtext(side = 3, text = paste0("(", letters[i], ")"), line = 0.7, at = 2, cex = 0.8)
if(i %in% c(9,10)){
mtext(side = 1, text = expression(paste("Basal area (m"^"2", " ha"^"-1", ")")), line = 2.8)
}
abline(coef(temp)[, 1], lty = ifelse(temp$coefficients[2, 4] < (0.05), 1, 2))
}
dev.off()
cairo_pdf(file ="./plots/FE-2020-00824_Figure_4.pdf",
width = 5,
height=8,
pointsize = 12)
par(mfrow = c(5,2))
par(oma = c(1,1,3,0), mar = c(4,5,1,1), family = "sans")
for(i in 1:length(traits_to_plot)){
trait <- traits_to_plot[i]
plot(plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA,
xlab = "",
ylab = "",
ylim = c(min(plot_agg_traits[, eval(substitute(trait))]), max(plot_agg_traits[, eval(substitute(trait))]) * 1.05),
pch = 21,
bg = "grey",
yaxt = "n")
axis(2, las = 2)
temp <- summary(lm( plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA))
if(!(i %in% c(3,4,5,9))){
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
} else{
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
}
mtext(side = 2, text = traits_names_clean[i], line = 2.6, cex = 0.8)
mtext(side = 3, text = paste0("(", letters[i], ")"), line = 0.7, at = 2, cex = 0.8)
if(i %in% c(9,10)){
mtext(side = 1, text = expression(paste("Basal area (m"^"2", " ha"^"-1", ")")), line = 2.8)
}
abline(coef(temp)[, 1], lty = ifelse(temp$coefficients[2, 4] < (0.05), 1, 2))
}
dev.off()
cairo_pdf(file ="./plots/FE-2020-00824_Figure_1.pdf",
width = 4,
height=4,
pointsize = 12)
par(mfrow = c(2,1))
par(oma = c(2,2.4,0,1))
par(mar = c(1,2,1,0))
cols <- c("black", "#1b9e77", "#E69F00")
pchs <- c(15,16,17)
plot(NA, ylim = c(0, 30), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend(x = -1, y = 31, legend = c("Forest", "Generalist", "Savanna"),
col = cols[c(1,2,3)], pch = pchs[c(1,2,3)], bty = "n")
mtext(side = 2, text = "Functional type", line = 3.4, adj = 0.5)
mtext(side = 2, text = expression(paste("basal area (m"^"2", " ha"^"-1", ")")), line = 2,
adj = 0.5)
mtext(side = 3, text = "(a)", at = 0)
axis(1, labels = FALSE)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2.5)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
svg(file ="./plots/traits_by_FG.svg",
width = 7,
height=4,
pointsize = 9)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
plot(clean_species_trans[, traits_names[i]] ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
yaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
axis(side = 2, las = 2)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
plot((clean_species_trans[, traits_names[i]]) ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs, las = 2)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 2.6)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("S-G", "S-F", "G-F")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
}
dev.off()
# load libraries
library("ggplot2")
library("plyr")
library("vegan")
library("multcomp")
library("multcompView")
library("effects")
library("maptools")
library("ape")
library("cluster")
library("phytools")
library("Hotelling")
set.seed(45750765)
traits_names_clean <- c(expression(paste("Leaf size (cm"^"2", ")")),
"Leaf thickness (mm)",
expression(paste("Specific leaf area (cm"^"2", " g"^"-1", ")")),
"Max height (m)",
"Height at 5 cm dia. (m)",
"       Crown ratio\nat 5cm dia. (unitless)",
"  Bark thickness\nat 5cm dia. (mm)",
"  Bark thickness\nat 8mm dia. (mm)",
expression(paste("Wood density (g cm"^"-3",")")),
"         Light code\nat 5 cm dia. (unitless)")
svg(file ="./plots/traits_by_FG.svg",
width = 7,
height=4,
pointsize = 9)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
plot(clean_species_trans[, traits_names[i]] ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
yaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
axis(side = 2, las = 2)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
plot((clean_species_trans[, traits_names[i]]) ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs, las = 2)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 2.6)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("S-G", "S-F", "G-F")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
}
dev.off()
svg(file ="./plots/FE-2020-00824_Figure_3.svg",
width = 7,
height=7,
pointsize = 9)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.12, -.05, 0.03, .05, -.06, .05, -.08, .05, -.15, 0.02)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
svg(file ="./plots/FE-2020-00824_Figure_3.svg",
width = 7,
height=7,
pointsize = 9)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-points(x = sp_scores[, 1], y = sp_scores[, 2], col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.12, -.05, 0.03, .05, -.06, .05, -.08, .05, -.15, 0.02)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
svg(file ="./plots/FE-2020-00824_Figure_3.svg",
width = 7,
height=7,
pointsize = 9)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-points(x = sp_scores[, 1], y = sp_scores[, 2], col = color_points, cex = 0.7,
pch = 21, bg = color_points)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.12, -.05, 0.03, .05, -.06, .05, -.08, .05, -.15, 0.02)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
svg(file ="./plots/FE-2020-00824_Figure_2.svg",
width = 7,
height=4,
pointsize = 9)
par(mfrow = c(2, 5),
mar = c(2,5.2,2,0.5),
oma = c(1, .3, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
yaxt = 'n',
xlim = c(0.5, 3.5),
ylim = ylim,
cex.lab = 1.3
)
axis(2, las = 2)
}else{ # for log-trans traits
# means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.5, 3.5),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs, las = 2)
}
#
# points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
# lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 2.3)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("S-G", "S-F", "G-F")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
#------------------------------------------------------------------------------
# What proportion of tree species sampled? For results section
#------------------------------------------------------------------------------
#calculate using both clean_species and clean_species_reduced
# total_ba <- sum(plot_data$CSA_30_expand, na.rm = TRUE)
# sampled_ba <- sum(plot_data[plot_data$Code %in% clean_species$Code, ]$CSA_30_expand, na.rm = TRUE)
sampled_ba/total_ba
#
# plot_ba <- aggregate(plot_data[, c("P", "CSA_30_expand")], by = list(plot_data$P), FUN = function(x){sum(x, na.rm=TRUE)})
# sampled_plot_ba <- aggregate(plot_data[plot_data$Code %in% clean_species$Code, c("P", "CSA_30_expand")],
#                              by = list(plot_data[plot_data$Code %in% clean_species$Code, ]$P), FUN = function(x){sum(x, na.rm=TRUE)})
sampled_plot_ba$CSA_30_expand / plot_ba$CSA_30_expand
