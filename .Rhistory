FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
yaxt = 'n',
xlim = c(0.5, 3.5),
ylim = ylim,
cex.lab = 1.3
)
axis(2, las = 2)
}else{ # for log-trans traits
# means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.5, 3.5),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs, las = 2)
}
#
# points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
# lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 2.3)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("S-G", "S-F", "G-F")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_3.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC3",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 3], trait_scores[, 3]) - .5)),
(max(c(sp_scores[, 3], trait_scores[, 3])) + 0.4)),
yaxt = "n")
abline(h = 0)
abline(v = 0)
axis(2, las = 2)
pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,3),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 3])
yoffsets <- c(0, -.05, -.05, 0, .05, 0, -.04, -.04, -.1, 0)
xoffsets <- c(0, 0, 0.23, 0, -.05, 0, -.25, -.25, 0, -0.2)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 3]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
tiff(filename="./plots/Figure_4_community_weighted_traits.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 5,
height=8,
pointsize=12,
res=600)
par(mfrow = c(5,2))
par(oma = c(1,1,3,0), mar = c(4,5,1,1), family = "sans")
for(i in 1:length(traits_to_plot)){
trait <- traits_to_plot[i]
plot(plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA,
xlab = "",
ylab = "",
ylim = c(min(plot_agg_traits[, eval(substitute(trait))]), max(plot_agg_traits[, eval(substitute(trait))]) * 1.05),
pch = 21,
bg = "grey",
yaxt = "n")
axis(2, las = 2)
temp <- summary(lm( plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA))
if(!(i %in% c(3,4,5,9))){
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
} else{
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
}
mtext(side = 2, text = traits_names_clean[i], line = 2, cex = 0.8)
mtext(side = 3, text = paste0("(", letters[i], ")"), line = 0.7, at = 2, cex = 0.8)
if(i %in% c(9,10)){
mtext(side = 1, text = expression(paste("Basal area (m"^"2", " ha"^"-1", ")")), line = 2.8)
}
abline(coef(temp)[, 1], lty = ifelse(temp$coefficients[2, 4] < (0.05), 1, 2))
}
dev.off()
tiff(filename="./plots/Figure_4_community_weighted_traits.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 5,
height=8,
pointsize=12,
res=600)
par(mfrow = c(5,2))
par(oma = c(1,1,3,0), mar = c(4,5,1,1), family = "sans")
for(i in 1:length(traits_to_plot)){
trait <- traits_to_plot[i]
plot(plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA,
xlab = "",
ylab = "",
ylim = c(min(plot_agg_traits[, eval(substitute(trait))]), max(plot_agg_traits[, eval(substitute(trait))]) * 1.05),
pch = 21,
bg = "grey",
yaxt = "n")
axis(2, las = 2)
temp <- summary(lm( plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA))
if(!(i %in% c(3,4,5,9))){
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
} else{
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
}
mtext(side = 2, text = traits_names_clean[i], line = 2, cex = 2)
mtext(side = 3, text = paste0("(", letters[i], ")"), line = 0.7, at = 2, cex = 0.8)
if(i %in% c(9,10)){
mtext(side = 1, text = expression(paste("Basal area (m"^"2", " ha"^"-1", ")")), line = 2.8)
}
abline(coef(temp)[, 1], lty = ifelse(temp$coefficients[2, 4] < (0.05), 1, 2))
}
dev.off()
tiff(filename="./plots/Figure_4_community_weighted_traits.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 5,
height=8,
pointsize=12,
res=600)
par(mfrow = c(5,2))
par(oma = c(1,1,3,0), mar = c(4,5,1,1), family = "sans")
for(i in 1:length(traits_to_plot)){
trait <- traits_to_plot[i]
plot(plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA,
xlab = "",
ylab = "",
ylim = c(min(plot_agg_traits[, eval(substitute(trait))]), max(plot_agg_traits[, eval(substitute(trait))]) * 1.05),
pch = 21,
bg = "grey",
yaxt = "n")
axis(2, las = 2)
temp <- summary(lm( plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA))
if(!(i %in% c(3,4,5,9))){
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
} else{
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
}
mtext(side = 2, text = traits_names_clean[i], line = 2.4, cex = 0.8)
mtext(side = 3, text = paste0("(", letters[i], ")"), line = 0.7, at = 2, cex = 0.8)
if(i %in% c(9,10)){
mtext(side = 1, text = expression(paste("Basal area (m"^"2", " ha"^"-1", ")")), line = 2.8)
}
abline(coef(temp)[, 1], lty = ifelse(temp$coefficients[2, 4] < (0.05), 1, 2))
}
dev.off()
tiff(filename="./plots/Figure_4_community_weighted_traits.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 5,
height=8,
pointsize=12,
res=600)
par(mfrow = c(5,2))
par(oma = c(1,1,3,0), mar = c(4,5,1,1), family = "sans")
for(i in 1:length(traits_to_plot)){
trait <- traits_to_plot[i]
plot(plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA,
xlab = "",
ylab = "",
ylim = c(min(plot_agg_traits[, eval(substitute(trait))]), max(plot_agg_traits[, eval(substitute(trait))]) * 1.05),
pch = 21,
bg = "grey",
yaxt = "n")
axis(2, las = 2)
temp <- summary(lm( plot_agg_traits[, eval(substitute(trait))] ~ plot_agg_traits$BA))
if(!(i %in% c(3,4,5,9))){
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[4] - .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
} else{
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .08*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = paste("r =", (round(sqrt(temp$r.squared), 2) * sign(coef(temp)[2,1])) ))
text(x = par()$usr[2] - .4*(par()$usr[2] - par()$usr[1]),
y = par()$usr[3] + .2*(par()$usr[4] - par()$usr[3]),
pos = 4,
labels = ifelse(coef(temp)[2, 4] > 0.001,
paste("p =", round(coef(temp)[2, 4], 3)),
"p < 0.001"))
}
mtext(side = 2, text = traits_names_clean[i], line = 2.6, cex = 0.8)
mtext(side = 3, text = paste0("(", letters[i], ")"), line = 0.7, at = 2, cex = 0.8)
if(i %in% c(9,10)){
mtext(side = 1, text = expression(paste("Basal area (m"^"2", " ha"^"-1", ")")), line = 2.8)
}
abline(coef(temp)[, 1], lty = ifelse(temp$coefficients[2, 4] < (0.05), 1, 2))
}
dev.off()
tiff(filename="./plots/change_in_FTs.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 4,
height=4,
pointsize=12,
res=600)
par(mfrow = c(2,1))
par(oma = c(2,2.4,0,1))
par(mar = c(1,2,1,0))
cols <- c("black", "#1b9e77", "#E69F00")
pchs <- c(15,16,17)
plot(NA, ylim = c(0, 30), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend(x = -1, y = 31, legend = c("Forest", "Generalist", "Savanna"),
col = cols[c(1,2,3)], pch = pchs[c(1,2,3)], bty = "n")
mtext(side = 2, text = "Functional type", line = 3.4, adj = 0.5)
mtext(side = 2, text = expression(paste("basal area (m"^"2", " ha"^"-1", ")")), line = 2,
adj = 0.5)
mtext(side = 3, text = "(a)", at = 0)
axis(1, labels = FALSE)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
tiff(filename="./plots/Figure_1_change_in_FTs.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 4,
height=4,
pointsize=12,
res=600)
par(mfrow = c(2,1))
par(oma = c(2,2.4,0,1))
par(mar = c(1,2,1,0))
cols <- c("black", "#1b9e77", "#E69F00")
pchs <- c(15,16,17)
plot(NA, ylim = c(0, 30), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend(x = -1, y = 31, legend = c("Forest", "Generalist", "Savanna"),
col = cols[c(1,2,3)], pch = pchs[c(1,2,3)], bty = "n")
mtext(side = 2, text = "Functional type", line = 3.4, adj = 0.5)
mtext(side = 2, text = expression(paste("basal area (m"^"2", " ha"^"-1", ")")), line = 2,
adj = 0.5)
mtext(side = 3, text = "(a)", at = 0)
axis(1, labels = FALSE)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
tiff(filename="./plots/Figure_1_change_in_FTs.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 4,
height=4,
pointsize=12,
res=600)
par(mfrow = c(2,1))
par(oma = c(2,2.4,0,1))
par(mar = c(1,2,1,0))
cols <- c("black", "#1b9e77", "#E69F00")
pchs <- c(15,16,17)
plot(NA, ylim = c(0, 30), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend(x = -1, y = 31, legend = c("Forest", "Generalist", "Savanna"),
col = cols[c(1,2,3)], pch = pchs[c(1,2,3)], bty = "n")
mtext(side = 2, text = "Functional type", line = 3.4, adj = 0.5)
mtext(side = 2, text = expression(paste("basal area (m"^"2", " ha"^"-1", ")")), line = 2,
adj = 0.5)
mtext(side = 3, text = "(a)", at = 0)
axis(1, labels = FALSE)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
tiff(filename="./plots/Figure_1_change_in_FTs.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 4,
height=4,
pointsize=12,
res=600)
par(mfrow = c(2,1))
par(oma = c(2,2.4,0,1))
par(mar = c(1,2,1,0))
cols <- c("black", "#1b9e77", "#E69F00")
pchs <- c(15,16,17)
plot(NA, ylim = c(0, 30), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend(x = -1, y = 31, legend = c("Forest", "Generalist", "Savanna"),
col = cols[c(1,2,3)], pch = pchs[c(1,2,3)], bty = "n")
mtext(side = 2, text = "Functional type", line = 3.4, adj = 0.5)
mtext(side = 2, text = expression(paste("basal area (m"^"2", " ha"^"-1", ")")), line = 2,
adj = 0.5)
mtext(side = 3, text = "(a)", at = 0)
axis(1, labels = FALSE)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2.5)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
