par(mfrow = c(2,1))
plot(SNC ~ scores_test[, 1])
plot(scores_test[, 1] ~ SNC)
abline(lm(scores_test[, 1] ~ SNC))
summary(lm(scores_test[, 1] ~ SNC))
plot(SNC ~ scores_test[, 2])
plot(scores_test[, 2] ~ SNC)
abline(lm(scores_test[, 2] ~ SNC))
summary(lm(scores_test[, 2] ~ SNC))
plot(SNC ~ scores_test[, 1])
plot(SNC ~ scores_test[, 1])
abline(SNC ~ lm(scores_test[, 1]))
summary(SNC ~ lm(scores_test[, 1]))
plot(SNC ~ scores_test[, 2] ~ SNC)
abline(SNC ~ lm(scores_test[, 2] ~ SNC))
summary(SNC ~ lm(scores_test[, 2] ~ SNC))
par(mfrow = c(2,1))
plot(SNC ~ scores_test[, 1])
abline(SNC ~ lm(scores_test[, 1]))
summary(SNC ~ lm(scores_test[, 1]))
plot(SNC ~ scores_test[, 2])
abline(SNC ~ lm(scores_test[, 2]))
summary(SNC ~ lm(scores_test[, 2]))
plot(SNC ~ scores_test[, 1])
abline(lm(SNC ~ scores_test[, 1]))
summary(lm(SNC ~ scores_test[, 1]))
plot(SNC ~ scores_test[, 2])
abline(lm(SNC ~ scores_test[, 2]))
summary(lm(SNC ~ scores_test[, 2]))
summary(lm(SNC ~ scores_test[, 2]))
abline(lm(SNC ~ scores_test[, 2]), lty = 2)
plot(SNC ~ scores_test[, 1])
abline(lm(SNC ~ scores_test[, 1]))
summary(lm(SNC ~ scores_test[, 1]))
plot(SNC ~ scores_test[, 2])
abline(lm(SNC ~ scores_test[, 2]), lty = 2)
summary(lm(SNC ~ scores_test[, 2]))
tiff(filename="./plots/pca_against_SNC.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 3,
height=6,
pointsize=12,
res=600)
par(mfrow = c(2,1))
plot(SNC ~ scores_test[, 1])
abline(lm(SNC ~ scores_test[, 1]))
summary(lm(SNC ~ scores_test[, 1]))
plot(SNC ~ scores_test[, 2])
abline(lm(SNC ~ scores_test[, 2]), lty = 2)
summary(lm(SNC ~ scores_test[, 2]))
dev.off()
tiff(filename="./plots/pca_against_SNC.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 3,
height=6,
pointsize=12,
res=600)
par(mfrow = c(2,1))
plot(SNC ~ scores_test[, 1],
xlab = "PC1")
abline(lm(SNC ~ scores_test[, 1]))
summary(lm(SNC ~ scores_test[, 1]))
plot(SNC ~ scores_test[, 2],
xlab = "PC2")
abline(lm(SNC ~ scores_test[, 2]), lty = 2)
summary(lm(SNC ~ scores_test[, 2]))
dev.off()
tiff(filename="./plots/traits_by_FG_boxplot.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=4,
pointsize=9,
res=600)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot((clean_species_trans[, traits_names[i]]) ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 1.9)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("G-S", "F-S", "F-G")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=TRUE)$Letters[c(3,1,2)]
#fixes letters sometimes being in the wrong order -- not sure why this happens?
if(tuke_letters[1] != "a"){
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters[c(3,1,2)]
}
#plot the tuke letters for phylogenetic ANOVA
# ylim <- par("usr")[c(3,4)]
# yrange <- abs(ylim[2]-ylim[1])
# if(i %in% log_trans_traits){
#   text(x = c(1,2,3), y = log(exp(ylim[2]) - exp((ylim[2] - ylim[1])*.1)), labels = tuke_letters, cex = 1.2)
# }else{
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
tiff(filename="./plots/traits_by_FG_boxplot.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=4,
pointsize=9,
res=600)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot((clean_species_trans[, traits_names[i]]) ~ clean_species_trans$FG),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 1.9)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("G-S", "F-S", "F-G")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=TRUE)$Letters[c(3,1,2)]
#fixes letters sometimes being in the wrong order -- not sure why this happens?
if(tuke_letters[1] != "a"){
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters[c(3,1,2)]
}
#plot the tuke letters for phylogenetic ANOVA
# ylim <- par("usr")[c(3,4)]
# yrange <- abs(ylim[2]-ylim[1])
# if(i %in% log_trans_traits){
#   text(x = c(1,2,3), y = log(exp(ylim[2]) - exp((ylim[2] - ylim[1])*.1)), labels = tuke_letters, cex = 1.2)
# }else{
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
tiff(filename="./plots/traits_by_FG_boxplot.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=4,
pointsize=9,
res=600)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ I(as.numeric(clean_species_trans$FG) + noise),
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 1.9)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("G-S", "F-S", "F-G")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=TRUE)$Letters[c(3,1,2)]
#fixes letters sometimes being in the wrong order -- not sure why this happens?
if(tuke_letters[1] != "a"){
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters[c(3,1,2)]
}
#plot the tuke letters for phylogenetic ANOVA
# ylim <- par("usr")[c(3,4)]
# yrange <- abs(ylim[2]-ylim[1])
# if(i %in% log_trans_traits){
#   text(x = c(1,2,3), y = log(exp(ylim[2]) - exp((ylim[2] - ylim[1])*.1)), labels = tuke_letters, cex = 1.2)
# }else{
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
tiff(filename="./plots/traits_by_FG_boxplot.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=4,
pointsize=9,
res=600)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 1.9)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("G-S", "F-S", "F-G")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=TRUE)$Letters[c(3,1,2)]
#fixes letters sometimes being in the wrong order -- not sure why this happens?
if(tuke_letters[1] != "a"){
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters[c(3,1,2)]
}
#plot the tuke letters for phylogenetic ANOVA
# ylim <- par("usr")[c(3,4)]
# yrange <- abs(ylim[2]-ylim[1])
# if(i %in% log_trans_traits){
#   text(x = c(1,2,3), y = log(exp(ylim[2]) - exp((ylim[2] - ylim[1])*.1)), labels = tuke_letters, cex = 1.2)
# }else{
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
library(vioplot)
tiff(filename="./plots/traits_by_FG_boxplot.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=4,
pointsize=9,
res=600)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
vioplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 1.9)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("G-S", "F-S", "F-G")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=TRUE)$Letters[c(3,1,2)]
#fixes letters sometimes being in the wrong order -- not sure why this happens?
if(tuke_letters[1] != "a"){
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters[c(3,1,2)]
}
#plot the tuke letters for phylogenetic ANOVA
# ylim <- par("usr")[c(3,4)]
# yrange <- abs(ylim[2]-ylim[1])
# if(i %in% log_trans_traits){
#   text(x = c(1,2,3), y = log(exp(ylim[2]) - exp((ylim[2] - ylim[1])*.1)), labels = tuke_letters, cex = 1.2)
# }else{
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
tiff(filename="./plots/traits_by_FG_boxplot.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=4,
pointsize=9,
res=600)
par(mfrow = c(2, 5),
mar = c(2,6,2,0.5),
oma = c(1, 0, 0, 0))
for (i in 1:length(traits_names)){
# model <- lm(clean_species_reduced[, traits_names[i]] ~ as.factor(clean_species_reduced$FG))
noise <- rnorm(nrow(clean_species_trans), 0, .02)
means <- aggregate(clean_species_trans[, traits_names[i]], by = list(as.factor(clean_species_trans$FG)),
FUN = mean, na.rm = TRUE)
if(!(i %in% log_trans_traits)){
ylim <- c((0.8 * min(clean_species_trans[, traits_names[i]], na.rm = TRUE, na.rm = TRUE)),
(1.2 * max(clean_species_trans[, traits_names[i]], na.rm = TRUE)))
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3
)
}else{ # for log-trans traits
means[, 2] <- (means[, 2])
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.3 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
if(i == 1){
ylim <- c(log(0.8 * min((clean_species[, traits_names[i]]), na.rm = TRUE)),
log(1.8 * max((clean_species[, traits_names[i]]), na.rm = TRUE)))
}
yrange <- abs(ylim[2]-ylim[1])
boxplot(clean_species_trans[, traits_names[i]] ~ clean_species_trans$FG,
xlab = "",
ylab = "",
xaxt = 'n',
xlim = c(0.8, 3.2),
ylim = ylim,
cex.lab = 1.3,
yaxt = "n"
)
ax_labs <- axisTicks(log10(range(exp(clean_species_trans[, traits_names[i]]), na.rm = TRUE)), log = TRUE, n = 5)
axis(side = 2, at = log(ax_labs), labels = ax_labs)
}
points(means[, 2] ~ c(1,2,3), pch = 18, cex = 2)
lines(means[, 2] ~ c(1,2,3), lty = 1, lwd = 2)
mtext(text = levels(clean_species_trans$FG), side = 1, at = c(1,2,3), line = 1)
mtext(text = paste0("(", letters[i], ")") , side = 3, at = 0.4, line = .3)
mtext(text = traits_names_clean[i], side = 2, line = 1.9)
pvals <- as.numeric(pvals_table[i, c(5:7)])
names(pvals) <- c("G-S", "F-S", "F-G")
pvals <- ifelse(pvals < (0.05), TRUE, FALSE)
tuke_letters <- multcompLetters(pvals, reversed=TRUE)$Letters[c(3,1,2)]
#fixes letters sometimes being in the wrong order -- not sure why this happens?
if(tuke_letters[1] != "a"){
tuke_letters <- multcompLetters(pvals, reversed=FALSE)$Letters[c(3,1,2)]
}
#plot the tuke letters for phylogenetic ANOVA
# ylim <- par("usr")[c(3,4)]
# yrange <- abs(ylim[2]-ylim[1])
# if(i %in% log_trans_traits){
#   text(x = c(1,2,3), y = log(exp(ylim[2]) - exp((ylim[2] - ylim[1])*.1)), labels = tuke_letters, cex = 1.2)
# }else{
text(x = c(1,2,3), y = ylim[2] - (ylim[2] - ylim[1])*.03, labels = tuke_letters, cex = 1.2)
# }
}
dev.off()
