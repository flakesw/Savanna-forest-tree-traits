i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
tiff(filename="./plots/Figure_1_change_in_FTs.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 4,
height=4,
pointsize=12,
res=600)
par(mfrow = c(2,1))
par(oma = c(2,2.4,0,1))
par(mar = c(1,2,1,0))
cols <- c("black", "#1b9e77", "#E69F00")
pchs <- c(15,16,17)
plot(NA, ylim = c(0, 30), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend(x = -1, y = 31, legend = c("Forest", "Generalist", "Savanna"),
col = cols[c(1,2,3)], pch = pchs[c(1,2,3)], bty = "n")
mtext(side = 2, text = "Functional type", line = 3.4, adj = 0.5)
mtext(side = 2, text = expression(paste("basal area (m"^"2", " ha"^"-1", ")")), line = 2,
adj = 0.5)
mtext(side = 3, text = "(a)", at = 0)
axis(1, labels = FALSE)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(plot_agg_traits[[type]] ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(plot_agg_traits[[type]] ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
lines(preds ~ newdata, col = cols[i], lwd = 2)
i <- i+1
}
plot(NA, ylim = c(0, 1), xlim = c(0, 30), xaxt = "n", yaxt = "n", ylab = "", xlab = "")
mtext(side = 2, text = "Proportion of BA", line = 2.5)
mtext(side = 1, text = expression(paste("Plot basal area (m"^"2", " ha"^"-1", ")")), line = 1, outer = TRUE,
adj = 0.5)
mtext(side = 3, text = "(b)", at = 0)
axis(1, labels = TRUE, padj = -.5)
axis(2, las = 2)
i <- 1
for (type in c("ForestBA", "GeneralistBA", "SavannaBA")){
points(I(plot_agg_traits[[type]]/BA) ~ BA, data = plot_agg_traits,
pch = pchs[i], bg = cols[i], col = cols[i])
newdata <- seq(0, 28, length.out = 100)
mod <- lm(I(plot_agg_traits[[type]]/plot_agg_traits$BA) ~ poly(BA,2), data = plot_agg_traits)
# print(coef(summary(mod))[2, 4])
preds <- predict(mod, newdata = list(BA = newdata))
if(type != "GeneralistBA"){lines(preds ~ newdata, col = cols[i], lwd = 2)}
i <- i+1
}
dev.off()
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_3.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC3",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 3], trait_scores[, 3]) - .5)),
(max(c(sp_scores[, 3], trait_scores[, 3])) + 0.4)),
yaxt = "n")
abline(h = 0)
abline(v = 0)
axis(2, las = 2)
pointLabel(x = sp_scores[, 1], y = sp_scores[, 3], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,3),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 3])
yoffsets <- c(0, -.05, -.05, 0, .05, 0, -.04, -.04, -.1, 0)
xoffsets <- c(0, 0, 0.23, 0, -.05, 0, -.25, -.25, 0, -0.2)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 3]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
# load libraries
library("ggplot2")
library("plyr")
library("vegan")
library("multcomp")
library("multcompView")
library("effects")
library("maptools")
library("ape")
library("cluster")
library("phytools")
library("Hotelling")
# setwd("C:\\Users\\Sam\\Google Drive\\Projects\\Savanna traits")
set.seed(45750765)
#----------------------------------------------------------------------------
# Function to plot elliptical hulls for phylogenetic PCA,
# modified from vegan::ordiellipse. I removed a bunch of functionality,
# so now it only draws elliptical hulls. I really forget why I had to butcher it.
#----------------------------------------------------------------------------
phyellipse <- function (ord, groups, display = "sites",
col = NULL,
show.groups, choices = c(1,2), ...)
{
pts <- ord$S
pts <- as.matrix(pts)
pts <- pts[, choices, drop = FALSE]
take <- groups %in% show.groups
pts <- pts[take, , drop = FALSE]
tmp <- ellipsoidhull(pts)
lines(predict(tmp), col = col)
}
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_3.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC3",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 3], trait_scores[, 3]) - .5)),
(max(c(sp_scores[, 3], trait_scores[, 3])) + 0.4)),
yaxt = "n")
abline(h = 0)
abline(v = 0)
axis(2, las = 2)
pointLabel(x = sp_scores[, 1], y = sp_scores[, 3], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,3),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 3])
yoffsets <- c(0, -.05, -.05, 0, .05, 0, -.04, -.04, -.1, 0)
xoffsets <- c(0, 0, 0.23, 0, -.05, 0, -.25, -.25, 0, -0.2)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 3]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.05, -.05, .12, .05, -.06, .05, -.065, .05, -.08, -.065)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
biplot(pca_results, choices = c(1,2))
trait_scores[, 1]
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.05, -.05, .12, .05, -.06, .05, -.065, .05, -.18, +.15)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
yoffsets
trait_scores[, 1]
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.05, -.05, 0, .05, -.06, .05, -.065, .05, -.12, 0)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.1, -.05, 0.03, .05, -.06, .05, -.065, .05, -.12, 0)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
# setwd("C:\\Users\\Sam\\Google Drive\\Projects\\Savanna traits")
set.seed(45750765)
set.seed(45750766)
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.1, -.05, 0.03, .05, -.06, .05, -.065, .05, -.12, 0)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
trait_scores[, 1]
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.12, -.05, 0.03, .05, -.06, .05, -.08, .05, -.15, 0.02)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
set.seed(45750766)
tiff(filename="./plots/Figure_3_traits_PCA_axes_1_2.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC2",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 2], trait_scores[, 2]) - .5)),
(max(c(sp_scores[, 2], trait_scores[, 2])) + 0.4)))
abline(h = 0)
abline(v = 0)
x<-pointLabel(x = sp_scores[, 1], y = sp_scores[, 2], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,2),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 2])
yoffsets <- c(0.12, -.05, 0.03, .05, -.06, .05, -.08, .05, -.15, 0.02)
xoffsets <- c(-0.15, -.33, 0, 0.2, -.05, 0, -.25, -.3, .27, -.3)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 2]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
tiff(filename="./plots/Figure_S2_traits_PCA_axes_1_3.tiff",
type = "cairo",
antialias = "gray",
compression = "lzw",
units="in",
width = 7,
height=7,
pointsize=9,
res=600)
color_groups <- data.frame(group = as.character(c("F", "G", "S")),
col = as.character(c("black", "#1b9e77", "#E69F00")))
color_points <- as.character(color_groups[match(pca_groups, color_groups$group), "col"])
plot(NA,
xlab = "PC1", ylab = "PC3",
xlim = c( (min(c(sp_scores[, 1], trait_scores[, 1]) - .5)),
(max(c(sp_scores[, 1], trait_scores[, 1])) + 0.4)),
ylim = c( (min(c(sp_scores[, 3], trait_scores[, 3]) - .5)),
(max(c(sp_scores[, 3], trait_scores[, 3])) + 0.4)),
yaxt = "n")
abline(h = 0)
abline(v = 0)
axis(2, las = 2)
pointLabel(x = sp_scores[, 1], y = sp_scores[, 3], labels = pca_sp_names, col = color_points, cex = 0.7)
for(i in 1:3){
ordiellipse(pca_results, pca_groups, show.groups = color_groups[i, 1],
col = as.character(color_groups[i, 2]), choices = c(1,3),
kind = "sd", conf = 0.90)
}
legend(x = par()$usr[1], y = par()$usr[4],
legend = c("Forest", "Generalist", "Savanna"),
col = c("black", "#1b9e77", "#E69F00"),
pt.bg = c("black", "#1b9e77", "#E69F00"),
pch = 21,
cex = 1.5,
bty = "n")
segments(x0 = 0, y0 = 0, x1 = trait_scores[, 1], y1 = trait_scores[, 3])
yoffsets <- c(0, -.05, -.05, 0, .05, 0, -.04, -.04, -.1, 0)
xoffsets <- c(0, 0, 0.23, 0, -.05, 0, -.25, -.25, 0, -0.2)
text(x = trait_scores[, 1]+xoffsets, y = trait_scores[, 3]+yoffsets, labels = trait_names, cex = 1.3)
dev.off()
summary(pca)
summary(results)
summary(pca_results)
